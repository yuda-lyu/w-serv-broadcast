/*!
 * w-serv-broadcast-client v1.0.0
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-serv-broadcast-client"]=r()}(this,(function(){"use strict";var t=Array.isArray,r="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=r||e||Function("return this")(),o=n.Symbol,i=Object.prototype,u=i.hasOwnProperty,c=i.toString,a=o?o.toStringTag:void 0;var f=Object.prototype.toString;var l=o?o.toStringTag:void 0;function s(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function(t){var r=u.call(t,a),e=t[a];try{t[a]=void 0;var n=!0}catch(t){}var o=c.call(t);return n&&(r?t[a]=e:delete t[a]),o}(t):function(t){return f.call(t)}(t)}function p(t){return null!=t&&"object"==typeof t}function y(t){return"symbol"==typeof t||p(t)&&"[object Symbol]"==s(t)}var h=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,v=/^\w*$/;function b(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}function d(t){if(!b(t))return!1;var r=s(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}var j,g=n["__core-js_shared__"],_=(j=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"";var O=Function.prototype.toString;var m=/^\[object .+?Constructor\]$/,A=Function.prototype,w=Object.prototype,S=A.toString,x=w.hasOwnProperty,z=RegExp("^"+S.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function T(t){return!(!b(t)||(r=t,_&&_ in r))&&(d(t)?z:m).test(function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var r}function $(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return T(e)?e:void 0}var E=$(Object,"create");var N=Object.prototype.hasOwnProperty;var P=Object.prototype.hasOwnProperty;function F(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function C(t,r){for(var e,n,o=t.length;o--;)if((e=t[o][0])===(n=r)||e!=e&&n!=n)return o;return-1}F.prototype.clear=function(){this.__data__=E?E(null):{},this.size=0},F.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},F.prototype.get=function(t){var r=this.__data__;if(E){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return N.call(r,t)?r[t]:void 0},F.prototype.has=function(t){var r=this.__data__;return E?void 0!==r[t]:P.call(r,t)},F.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=E&&void 0===r?"__lodash_hash_undefined__":r,this};var I=Array.prototype.splice;function M(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}M.prototype.clear=function(){this.__data__=[],this.size=0},M.prototype.delete=function(t){var r=this.__data__,e=C(r,t);return!(e<0)&&(e==r.length-1?r.pop():I.call(r,e,1),--this.size,!0)},M.prototype.get=function(t){var r=this.__data__,e=C(r,t);return e<0?void 0:r[e][1]},M.prototype.has=function(t){return C(this.__data__,t)>-1},M.prototype.set=function(t,r){var e=this.__data__,n=C(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var U=$(n,"Map");function k(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function B(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}B.prototype.clear=function(){this.size=0,this.__data__={hash:new F,map:new(U||M),string:new F}},B.prototype.delete=function(t){var r=k(this,t).delete(t);return this.size-=r?1:0,r},B.prototype.get=function(t){return k(this,t).get(t)},B.prototype.has=function(t){return k(this,t).has(t)},B.prototype.set=function(t,r){var e=k(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function R(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return e.cache=i.set(o,u)||i,u};return e.cache=new(R.Cache||B),e}R.Cache=B;var W,q,D,G=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,L=/\\(\\)?/g,V=(W=function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(G,(function(t,e,n,o){r.push(n?o.replace(L,"$1"):e||t)})),r},q=R(W,(function(t){return 500===D.size&&D.clear(),t})),D=q.cache,q),H=V;var J=o?o.prototype:void 0,K=J?J.toString:void 0;function Q(r){if("string"==typeof r)return r;if(t(r))return function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}(r,Q)+"";if(y(r))return K?K.call(r):"";var e=r+"";return"0"==e&&1/r==-1/0?"-0":e}function X(t){return null==t?"":Q(t)}function Y(r,e){return t(r)?r:function(r,e){if(t(r))return!1;var n=typeof r;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=r&&!y(r))||v.test(r)||!h.test(r)||null!=e&&r in Object(e)}(r,e)?[r]:H(X(r))}function Z(t){if("string"==typeof t||y(t))return t;var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}function tt(t,r,e){var n=null==t?void 0:function(t,r){for(var e=0,n=(r=Y(r,t)).length;null!=t&&e<n;)t=t[Z(r[e++])];return e&&e==n?t:void 0}(t,r);return void 0===n?e:n}function rt(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t}var et,nt=function(t,r,e){for(var n=-1,o=Object(t),i=e(t),u=i.length;u--;){var c=i[et?u:++n];if(!1===r(o[c],c,o))break}return t};function ot(t){return p(t)&&"[object Arguments]"==s(t)}var it=Object.prototype,ut=it.hasOwnProperty,ct=it.propertyIsEnumerable,at=ot(function(){return arguments}())?ot:function(t){return p(t)&&ut.call(t,"callee")&&!ct.call(t,"callee")},ft=at;var lt="object"==typeof exports&&exports&&!exports.nodeType&&exports,st=lt&&"object"==typeof module&&module&&!module.nodeType&&module,pt=st&&st.exports===lt?n.Buffer:void 0,yt=(pt?pt.isBuffer:void 0)||function(){return!1},ht=/^(?:0|[1-9]\d*)$/;function vt(t,r){var e=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&ht.test(t))&&t>-1&&t%1==0&&t<r}function bt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var dt={};dt["[object Float32Array]"]=dt["[object Float64Array]"]=dt["[object Int8Array]"]=dt["[object Int16Array]"]=dt["[object Int32Array]"]=dt["[object Uint8Array]"]=dt["[object Uint8ClampedArray]"]=dt["[object Uint16Array]"]=dt["[object Uint32Array]"]=!0,dt["[object Arguments]"]=dt["[object Array]"]=dt["[object ArrayBuffer]"]=dt["[object Boolean]"]=dt["[object DataView]"]=dt["[object Date]"]=dt["[object Error]"]=dt["[object Function]"]=dt["[object Map]"]=dt["[object Number]"]=dt["[object Object]"]=dt["[object RegExp]"]=dt["[object Set]"]=dt["[object String]"]=dt["[object WeakMap]"]=!1;var jt="object"==typeof exports&&exports&&!exports.nodeType&&exports,gt=jt&&"object"==typeof module&&module&&!module.nodeType&&module,_t=gt&&gt.exports===jt&&r.process,Ot=function(){try{var t=gt&&gt.require&&gt.require("util").types;return t||_t&&_t.binding&&_t.binding("util")}catch(t){}}(),mt=Ot&&Ot.isTypedArray,At=mt?function(t){return function(r){return t(r)}}(mt):function(t){return p(t)&&bt(t.length)&&!!dt[s(t)]},wt=At,St=Object.prototype.hasOwnProperty;function xt(r,e){var n=t(r),o=!n&&ft(r),i=!n&&!o&&yt(r),u=!n&&!o&&!i&&wt(r),c=n||o||i||u,a=c?function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}(r.length,String):[],f=a.length;for(var l in r)!e&&!St.call(r,l)||c&&("length"==l||i&&("offset"==l||"parent"==l)||u&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||vt(l,f))||a.push(l);return a}var zt=Object.prototype;var Tt=function(t,r){return function(e){return t(r(e))}}(Object.keys,Object),$t=Tt,Et=Object.prototype.hasOwnProperty;function Nt(t){if(e=(r=t)&&r.constructor,r!==("function"==typeof e&&e.prototype||zt))return $t(t);var r,e,n=[];for(var o in Object(t))Et.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Pt(t){return null!=t&&bt(t.length)&&!d(t)}function Ft(t){return Pt(t)?xt(t):Nt(t)}var Ct=function(t,r){return function(e,n){if(null==e)return e;if(!Pt(e))return t(e,n);for(var o=e.length,i=r?o:-1,u=Object(e);(r?i--:++i<o)&&!1!==n(u[i],i,u););return e}}((function(t,r){return t&&nt(t,r,Ft)})),It=Ct;function Mt(t){return t}function Ut(r,e){var n;return(t(r)?rt:It)(r,"function"==typeof(n=e)?n:Mt)}function kt(t){return"[object Object]"===Object.prototype.toString.call(t)}function Bt(t){return"[object String]"===Object.prototype.toString.call(t)}function Rt(t){return!(!Bt(t)||""===t)}function Wt(t){return t!=t}function qt(t){let r=!1;if(Rt(t))r=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Wt(t))return!1;r=!0}return r}var Dt=/\s/;var Gt=/^\s+/;function Lt(t){return t?t.slice(0,function(t){for(var r=t.length;r--&&Dt.test(t.charAt(r)););return r}(t)+1).replace(Gt,""):t}var Vt=/^[-+]0x[0-9a-f]+$/i,Ht=/^0b[01]+$/i,Jt=/^0o[0-7]+$/i,Kt=parseInt;function Qt(t){if("number"==typeof t)return t;if(y(t))return NaN;if(b(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=b(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=Lt(t);var e=Ht.test(t);return e||Jt.test(t)?Kt(t.slice(2),e?2:8):Vt.test(t)?NaN:+t}var Xt=1/0;function Yt(t){return t?(t=Qt(t))===Xt||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function Zt(t){var r=Yt(t),e=r%1;return r==r?e?r-e:r:0}function tr(t){if(!qt(t))return 0;return Yt(t)}function rr(t){return!!qt(t)&&(t=tr(t),"number"==typeof(r=t)&&r==Zt(r));var r}var er=n.isFinite,nr=Math.min;var or=function(t){var r=Math[t];return function(t,e){if(t=Qt(t),(e=null==e?0:nr(Zt(e),292))&&er(t)){var n=(X(t)+"e").split("e");return+((n=(X(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round"),ir=or;function ur(t){if(!qt(t))return 0;t=tr(t);let r=ir(t);return"0"===String(r)?0:r}function cr(t){return"[object Array]"===Object.prototype.toString.call(t)}function ar(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(kt(t)){for(let r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Bt(t)||""!==t)}(t)||(!!function(t){return!!cr(t)&&0===t.length}(t)||!!Wt(t)))))}let fr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),lr=fr.length;function sr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,r=[];var e;t=rr(e=t)&&ur(e)>0?ur(t):32;for(let e=0;e<t;e++)r[e]=fr[0|Math.random()*lr];return r.join("")}return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){if(kt(t)){for(let r in t)return!0;return!1}return!1}(t))throw new Error("invalid initWConverhpClient");if(n="emit",!kt(e=t)||!Rt(n)&&!qt(n)||!(n in e))throw new Error("initWConverhpClient is not an EventEmitter");var e,n;let o=tt(r,"timePolling");var i;rr(i=o)&&ur(i)>=0||(o=2e3),o=ur(o);let u=tt(t,"clientId");return Rt(u)||(u=sr()),setInterval((()=>{t.execute("[sys:polling]",{clientId:u},(function(t,r,e){})).then((function(r){(function(t){return!(!cr(t)||0===t.length||1===t.length&&ar(t[0]))})(r)&&Ut(r,(r=>{!function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];setTimeout((()=>{t.emit(r,...n)}),1)}("broadcast",tt(r,"data",null))}))})).catch((function(t){console.log("polling err",t)}))}),o),t}}));
//# sourceMappingURL=w-serv-broadcast-client.umd.js.map
